{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Matth\\\\Documents\\\\Projects\\\\extremelypure\\\\client\\\\src\\\\components\\\\Root.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, createContext } from \"react\";\nimport Logo from \"./Logo\";\nimport Nav from \"../Nav\";\nimport Home from \"./home/Home\";\nimport ShoppingCart from \"./ShoppingCart\";\nimport { Outlet, useLocation } from \"react-router-dom\";\nimport CheckoutForm from \"./CheckoutForm\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const UserContext = /*#__PURE__*/createContext();\nexport const UserContextUpdater = /*#__PURE__*/createContext();\nfunction Root() {\n  _s();\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [cartVisible, setCartVisible] = useState(false);\n  const [cart, setCart] = useState([]);\n  const [quantities, setQuantities] = useState({});\n  const location = useLocation();\n  const isHomeRoute = location.pathname === \"/\";\n  useEffect(() => {\n    verifyToken();\n  }, []);\n  const verifyToken = () => {\n    fetch(\"http://localhost:3001/users/verifytoken\", {\n      credentials: 'include'\n    }).then(response => response.json()).then(tokenVerification => {\n      if (tokenVerification.error) {\n        setLoggedIn(false);\n      } else {\n        setLoggedIn(true);\n      }\n    }).catch(error => {\n      console.error('Error:', error);\n      setLoggedIn(false);\n    });\n  };\n  const signout = () => {\n    fetch(\"http://localhost:3001/users/clearcookie\", {\n      credentials: 'include'\n    }).then(response => response.json()).then(tokenDeletion => {\n      if (tokenDeletion.error) {\n        setLoggedIn(true);\n      } else {\n        setLoggedIn(false);\n      }\n    }).catch(error => {\n      console.error('Error:', error);\n      setLoggedIn(true);\n    });\n  };\n  const toggleCartVisibility = () => {\n    setCartVisible(!cartVisible);\n  };\n  const addItemToCart = product => {\n    setCart(prevCart => {\n      const isProductInCart = prevCart.some(item => item.id === product.id);\n      if (!isProductInCart) {\n        const newProduct = {\n          ...product,\n          quantity: (product.quantity || 0) + 1\n        };\n        return [...prevCart, newProduct];\n      } else {\n        return prevCart.map(item => item.id === product.id ? {\n          ...item,\n          quantity: item.quantity + 1\n        } : item);\n      }\n    });\n    setQuantities(prevQuantities => ({\n      ...prevQuantities,\n      [product.id]: (prevQuantities[product.id] || 0) + 1\n    }));\n  };\n  const removeItemFromCart = product => {\n    setCart(prevCart => {\n      return prevCart.map(item => item.id === product.id ? {\n        ...item,\n        quantity: item.quantity - 1\n      } : item).filter(item => item.quantity > 0);\n    });\n    setQuantities(prevQuantities => {\n      const newQuantities = {\n        ...prevQuantities\n      };\n      const newQuantity = (newQuantities[product.id] || 0) - 1;\n      if (newQuantity <= 0) {\n        delete newQuantities[product.id];\n      } else {\n        newQuantities[product.id] = newQuantity;\n      }\n      return newQuantities;\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: loggedIn,\n    children: /*#__PURE__*/_jsxDEV(UserContextUpdater.Provider, {\n      value: {\n        setLoggedIn\n      },\n      children: /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Logo, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Nav, {\n          toggleCart: toggleCartVisibility,\n          signout: signout\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this), isHomeRoute && /*#__PURE__*/_jsxDEV(Home, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 27\n        }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n          className: \"flex justify-center mt-1\",\n          children: /*#__PURE__*/_jsxDEV(Outlet, {\n            context: {\n              cart,\n              addItemToCart,\n              removeItemFromCart,\n              quantities,\n              verifyToken\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ShoppingCart, {\n          visible: cartVisible,\n          toggleCart: toggleCartVisibility,\n          cart: cart,\n          addItemToCart: addItemToCart,\n          removeItemFromCart: removeItemFromCart,\n          quantities: quantities\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 5\n  }, this);\n}\n_s(Root, \"BUuCF8NEJCssEsvyJ8wDQ5G9yCI=\", false, function () {\n  return [useLocation];\n});\n_c = Root;\nexport default Root;\nvar _c;\n$RefreshReg$(_c, \"Root\");","map":{"version":3,"names":["React","useEffect","useState","createContext","Logo","Nav","Home","ShoppingCart","Outlet","useLocation","CheckoutForm","jsxDEV","_jsxDEV","Fragment","_Fragment","UserContext","UserContextUpdater","Root","_s","loggedIn","setLoggedIn","cartVisible","setCartVisible","cart","setCart","quantities","setQuantities","location","isHomeRoute","pathname","verifyToken","fetch","credentials","then","response","json","tokenVerification","error","catch","console","signout","tokenDeletion","toggleCartVisibility","addItemToCart","product","prevCart","isProductInCart","some","item","id","newProduct","quantity","map","prevQuantities","removeItemFromCart","filter","newQuantities","newQuantity","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","toggleCart","className","context","visible","_c","$RefreshReg$"],"sources":["C:/Users/Matth/Documents/Projects/extremelypure/client/src/components/Root.js"],"sourcesContent":["import React, { useEffect, useState, createContext } from \"react\";\r\nimport Logo from \"./Logo\";\r\nimport Nav from \"../Nav\";\r\nimport Home from \"./home/Home\";\r\nimport ShoppingCart from \"./ShoppingCart\";\r\nimport { Outlet, useLocation } from \"react-router-dom\";\r\nimport CheckoutForm from \"./CheckoutForm\";\r\n\r\nexport const UserContext = createContext();\r\nexport const UserContextUpdater = createContext();\r\n\r\nfunction Root() {\r\n  const [loggedIn, setLoggedIn] = useState(false);\r\n  const [cartVisible, setCartVisible] = useState(false);\r\n  const [cart, setCart] = useState([]);\r\n  const [quantities, setQuantities] = useState({});\r\n\r\n  const location = useLocation();\r\n  const isHomeRoute = location.pathname === \"/\";\r\n\r\n  useEffect(() => {\r\n    verifyToken();\r\n  }, []);\r\n\r\n  const verifyToken = () => {\r\n    fetch(\"http://localhost:3001/users/verifytoken\", {\r\n      credentials: 'include',\r\n    })\r\n    .then(response => response.json())\r\n    .then(tokenVerification => {\r\n      if (tokenVerification.error) {\r\n        setLoggedIn(false);\r\n      } else {\r\n        setLoggedIn(true);\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error:', error);\r\n      setLoggedIn(false);\r\n    });\r\n  }\r\n\r\n  const signout = () => {\r\n    fetch(\"http://localhost:3001/users/clearcookie\", {\r\n      credentials: 'include',\r\n    })\r\n    .then(response => response.json())\r\n    .then(tokenDeletion => {\r\n      if (tokenDeletion.error) {\r\n        setLoggedIn(true);\r\n      } else {\r\n        setLoggedIn(false);\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error:', error);\r\n      setLoggedIn(true);\r\n    });\r\n  }\r\n\r\n  const toggleCartVisibility = () => {\r\n    setCartVisible(!cartVisible);\r\n  };\r\n\r\n  const addItemToCart = (product) => {\r\n    setCart((prevCart) => {\r\n      const isProductInCart = prevCart.some(item => item.id === product.id);\r\n\r\n      if (!isProductInCart) {\r\n        const newProduct = { ...product, quantity: (product.quantity || 0) + 1 };\r\n        return [...prevCart, newProduct];\r\n      } else {\r\n        return prevCart.map(item =>\r\n          item.id === product.id\r\n            ? { ...item, quantity: item.quantity + 1 }\r\n            : item\r\n        );\r\n      }\r\n    });\r\n\r\n    setQuantities((prevQuantities) => ({\r\n      ...prevQuantities,\r\n      [product.id]: (prevQuantities[product.id] || 0) + 1,\r\n    }));\r\n  };\r\n\r\n  const removeItemFromCart = (product) => {\r\n    setCart((prevCart) => {\r\n      return prevCart\r\n        .map(item =>\r\n          item.id === product.id\r\n            ? { ...item, quantity: item.quantity - 1 }\r\n            : item\r\n        )\r\n        .filter(item => item.quantity > 0);\r\n    });\r\n  \r\n    setQuantities((prevQuantities) => {\r\n      const newQuantities = { ...prevQuantities };\r\n      const newQuantity = (newQuantities[product.id] || 0) - 1;\r\n  \r\n      if (newQuantity <= 0) {\r\n        delete newQuantities[product.id];\r\n      } else {\r\n        newQuantities[product.id] = newQuantity;\r\n      }\r\n  \r\n      return newQuantities;\r\n    });\r\n  };\r\n\r\n  return (\r\n    <UserContext.Provider value={loggedIn}>\r\n      <UserContextUpdater.Provider value={{ setLoggedIn }}>\r\n        <>\r\n          <Logo />\r\n          <Nav toggleCart={toggleCartVisibility} signout={signout} />\r\n          {isHomeRoute && <Home />}\r\n          <main className=\"flex justify-center mt-1\">\r\n            <Outlet context={{ cart, addItemToCart, removeItemFromCart, quantities, verifyToken }} />\r\n          </main>\r\n          <ShoppingCart \r\n            visible={cartVisible} \r\n            toggleCart={toggleCartVisibility} \r\n            cart={cart} \r\n            addItemToCart={addItemToCart} \r\n            removeItemFromCart={removeItemFromCart} \r\n            quantities={quantities} \r\n          />\r\n        </>\r\n      </UserContextUpdater.Provider>\r\n    </UserContext.Provider>\r\n  );\r\n}\r\n\r\nexport default Root;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}